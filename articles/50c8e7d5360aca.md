---
title: "gitbucket-commitgraphs-plugin ã‚’ä¿®æ­£ã—ã‚ˆã†ã¨ã—ãŸã‚‰ãƒãƒã£ãŸè©±"
emoji: "ğŸ¦"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['GitBucket', 'Scala']
published: true
---
## æ¦‚è¦

[GitBucket](https://gitbucket.github.io/) ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ [gitbucket-commitgraphs-plugin](https://github.com/yoshiyoshifujii/gitbucket-commitgraphs-plugin) ã¯ã€é–‹ç™ºè€…ã®ã‚³ãƒŸãƒƒãƒˆçŠ¶æ³ã‚’ã‚°ãƒ©ãƒ•ã§è¡¨ç¤ºã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã™ã€‚

ã‚°ãƒ©ãƒ•ã®æç”»ã«ã¯ã€[Google Charts](https://developers.google.com/chart) ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã«æ¥ç¶šã§ããªã„ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ç’°å¢ƒã§ã¯ã€ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚

ã‚ã¾ã‚Šéœ€è¦ã¯ãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å€‹äººçš„ã«ã‚¯ãƒ­ãƒ¼ã‚ºãƒ‰ç’°å¢ƒã«å¯¾å¿œã•ã›ãŸãã€ä¿®æ­£ã‚’è©¦ã¿ãŸã®ã§ã™ãŒã€è¬ã®ä¾å­˜é–¢ä¿‚ã«ãƒãƒã£ã¦ã—ã¾ã£ãŸã¨ã„ã†ãŠè©±ã§ã™ã€‚

## å‰å›ã®è¨˜äº‹

https://zenn.dev/yasumichi/articles/baba54cf0b760f

## æœ€çµ‚çš„ãªæˆæœ

æœ¬å½“ã¯ã€æœ¬å®¶ã«ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ãƒˆã§ãã‚‹ã‚ˆã†ã«ã—ãŸã‹ã£ãŸã®ã§ã™ãŒã€å¾Œè¿°ã®äº‹æƒ…ã«ã‚ˆã‚Šã€[GitBucket Commit Graphs Chart.js Plugin](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin) ã¨ã„ã†åˆ¥ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸã€‚

ãƒãƒ¼ã‚¸ãƒ§ãƒ³ [v0.1.0](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/releases/tag/v0.1.0) ã¨ã—ã¦ãƒªãƒªãƒ¼ã‚¹ã—ã¾ã—ãŸã®ã§ãŠè©¦ã—ã„ãŸã ã‘ã¾ã™ã¨å¹¸ã„ã§ã™ã€‚

[Google Charts](https://developers.google.com/chart) ã®ä»£ã‚ã‚Šã« [chart.js](https://www.chartjs.org/) ã‚’åŒæ¢±ã—ã€åˆ©ç”¨ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

ã‚ªãƒªã‚¸ãƒŠãƒ«ç‰ˆã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã—ãŸã€‚

![](https://storage.googleapis.com/zenn-user-upload/892f2de08414-20251230.png)

æ”¹é€ ç‰ˆã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/6ef8f1823f02-20251230.png)

ãªãŠã€æ—¥ä»˜ã®è¡¨ç¤ºã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨€èªè¨­å®šã«ã‚ˆã‚Šå¤‰ã‚ã‚Šã¾ã™ã€‚

## è¬ã®ä¾å­˜é–¢ä¿‚

[gitbucket-commitgraphs-plugin](https://github.com/yoshiyoshifujii/gitbucket-commitgraphs-plugin) ã‚’ [Fork](https://github.com/yasumichi/gitbucket-commitgraphs-plugin) ã—ã€clone ã—ã¦ãƒ“ãƒ«ãƒ‰ã—ã‚ˆã†ã¨ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ã«é­é‡ã—ã¾ã—ãŸã€‚

```
[warn]  Note: Unresolved dependencies path:
[error] sbt.librarymanagement.ResolveException: Error downloading com.github.bkromhout:java-diff-utils:2.1.1
[error]   Not found
[error]   Not found
[error]   not found: C:\Users\username\.ivy2\local\com.github.bkromhout\java-diff-utils\2.1.1\ivys\ivy.xml
[error]   not found: https://jcenter.bintray.com/com/github/bkromhout/java-diff-utils/2.1.1/java-diff-utils-2.1.1.pom
[error]   not found: https://repo1.maven.org/maven2/com/github/bkromhout/java-diff-utils/2.1.1/java-diff-utils-2.1.1.pom
[error]   not found: https://dl.bintray.com/bkromhout/maven/com/github/bkromhout/java-diff-utils/2.1.1/java-diff-utils-2.1.1.pom
[error]         at lmcoursier.CoursierDependencyResolution.unresolvedWarningOrThrow(CoursierDependencyResolution.scala:258)
[error]         at lmcoursier.CoursierDependencyResolution.$anonfun$update$38(CoursierDependencyResolution.scala:227)
[error]         at scala.util.Either$LeftProjection.map(Either.scala:573)
[error]         at lmcoursier.CoursierDependencyResolution.update(CoursierDependencyResolution.scala:227)
[error]         at sbt.librarymanagement.DependencyResolution.update(DependencyResolution.scala:60)
[error]         at sbt.internal.LibraryManagement$.resolve$1(LibraryManagement.scala:53)
[error]         at sbt.internal.LibraryManagement$.$anonfun$cachedUpdate$12(LibraryManagement.scala:103)
[error]         at sbt.util.Tracked$.$anonfun$lastOutput$1(Tracked.scala:73)
[error]         at sbt.internal.LibraryManagement$.$anonfun$cachedUpdate$20(LibraryManagement.scala:116)
[error]         at scala.util.control.Exception$Catch.apply(Exception.scala:228)
[error]         at sbt.internal.LibraryManagement$.$anonfun$cachedUpdate$11(LibraryManagement.scala:116)
[error]         at sbt.internal.LibraryManagement$.$anonfun$cachedUpdate$11$adapted(LibraryManagement.scala:97)
[error]         at sbt.util.Tracked$.$anonfun$inputChangedW$1(Tracked.scala:219)
[error]         at sbt.internal.LibraryManagement$.cachedUpdate(LibraryManagement.scala:130)
[error]         at sbt.Classpaths$.$anonfun$updateTask0$5(Defaults.scala:3485)
[error]         at scala.Function1.$anonfun$compose$1(Function1.scala:49)
[error]         at sbt.internal.util.$tilde$greater.$anonfun$$u2219$1(TypeFunctions.scala:62)
[error]         at sbt.std.Transform$$anon$4.work(Transform.scala:68)
[error]         at sbt.Execute.$anonfun$submit$2(Execute.scala:282)
[error]         at sbt.internal.util.ErrorHandling$.wideConvert(ErrorHandling.scala:23)
[error]         at sbt.Execute.work(Execute.scala:291)
[error]         at sbt.Execute.$anonfun$submit$1(Execute.scala:282)
[error]         at sbt.ConcurrentRestrictions$$anon$4.$anonfun$submitValid$1(ConcurrentRestrictions.scala:265)
[error]         at sbt.CompletionService$$anon$2.call(CompletionService.scala:64)
[error]         at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
[error]         at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
[error]         at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
[error]         at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
[error]         at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
[error]         at java.base/java.lang.Thread.run(Thread.java:840)
[error] (update) sbt.librarymanagement.ResolveException: Error downloading com.github.bkromhout:java-diff-utils:2.1.1
[error]   Not found
[error]   Not found
[error]   not found: C:\Users\username\.ivy2\local\com.github.bkromhout\java-diff-utils\2.1.1\ivys\ivy.xml
[error]   not found: https://jcenter.bintray.com/com/github/bkromhout/java-diff-utils/2.1.1/java-diff-utils-2.1.1.pom
[error]   not found: https://repo1.maven.org/maven2/com/github/bkromhout/java-diff-utils/2.1.1/java-diff-utils-2.1.1.pom
[error]   not found: https://dl.bintray.com/bkromhout/maven/com/github/bkromhout/java-diff-utils/2.1.1/java-diff-utils-2.1.1.pom
```

[java-diff-utils](https://java-diff-utils.github.io/java-diff-utils/) ã® `groupId` ãŒå¤‰ã‚ã£ã¦ã—ã¾ã£ãŸã®ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ããªã„ã®ã ã¨æ€ã„ã¾ã™ãŒã€ãã‚‚ãã‚‚ãªãœ java-diff-utils ã¸ã®ä¾å­˜ã‚’æ‹¾ã£ã¦ãã‚‹ã®ã‹ã‚‰ã€è¦‹å½“ãŒã¤ãã¾ã›ã‚“ã€‚

java-diff-utils ã¨ã„ã†æ–‡å­—åˆ—ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãªã„ã‚’æ¤œç´¢ã—ã¦ã¿ã¾ã—ãŸãŒã€å½“è©²ãƒ­ã‚°ãŒå¼•ã£ã‹ã‹ã‚‹ã®ã¿ã§ã™ã€‚

## ä¾å­˜é–¢ä¿‚ãƒ„ãƒªãƒ¼ã‚’è¡¨ç¤ºã—ã¦ã¿ã‚‹

`sbt dependencyTree` ã§ä¾å­˜é–¢ä¿‚ã‚’èª¿ã¹ã¦ã¿ã¾ã—ãŸã€‚

```
>sbt dependencyTree
WARNING: A terminally deprecated method in java.lang.System has been called
WARNING: System::setSecurityManager has been called by sbt.TrapExit$ (file:/C:/Users/username/.sbt/boot/scala-2.12.12/org.scala-sbt/sbt/1.4.4/run_2.12-1.4.4.jar)
WARNING: Please consider reporting this to the maintainers of sbt.TrapExit$
WARNING: System::setSecurityManager will be removed in a future release
[info] welcome to sbt 1.4.4 (Eclipse Adoptium Java 17.0.15)
[info] loading settings for project gitbucket-commitgraphs-plugin-build from plugins.sbt ...
[info] loading project definition from C:\Users\username\gitbucket-commitgraphs-plugin\project
[info] loading settings for project root from build.sbt ...
[info] set current project to gitbucket-commitgraphs-plugin (in build file:/C:/Users/username/gitbucket-commitgraphs-plugin/)
[info] me.huzi.gitbucket:gitbucket-commitgraphs-plugin_2.13:4.35.0 [S]
[info]   +-com.typesafe.play:twirl-api_2.13:1.4.2 [S]
[info]     +-org.scala-lang.modules:scala-xml_2.13:1.2.0 [S]
[info]
[success] Total time: 13 s, completed 2025/12/30 9:07:09
```

ã‚„ã¯ã‚Šã€java-diff-utils ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚

ã‚¹ã‚³ãƒ¼ãƒ—ã‚’å¤‰ãˆã¦ `sbt runtime:dependencyTree` ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```
>sbt runtime:dependencyTree
WARNING: A terminally deprecated method in java.lang.System has been called
WARNING: System::setSecurityManager has been called by sbt.TrapExit$ (file:/C:/Users/username/.sbt/boot/scala-2.12.12/org.scala-sbt/sbt/1.4.4/run_2.12-1.4.4.jar)
WARNING: Please consider reporting this to the maintainers of sbt.TrapExit$
WARNING: System::setSecurityManager will be removed in a future release
[info] welcome to sbt 1.4.4 (Eclipse Adoptium Java 17.0.15)
[info] loading settings for project gitbucket-commitgraphs-plugin-build from plugins.sbt ...
[info] loading project definition from C:\Users\username\gitbucket-commitgraphs-plugin\project
[info] loading settings for project root from build.sbt ...
[info] set current project to gitbucket-commitgraphs-plugin (in build file:/C:/Users/username/gitbucket-commitgraphs-plugin/)
[info] me.huzi.gitbucket:gitbucket-commitgraphs-plugin_2.13:4.35.0 [S]
[info]   +-com.typesafe.play:twirl-api_2.13:1.4.2 [S]
[info]     +-org.scala-lang.modules:scala-xml_2.13:1.2.0 [S]
[info]
[success] Total time: 0 s, completed 2025/12/30 9:08:05
```

ã•ã‚‰ã« `sbt test:dependencyTree` ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```
>sbt test:dependencyTree
WARNING: A terminally deprecated method in java.lang.System has been called
WARNING: System::setSecurityManager has been called by sbt.TrapExit$ (file:/C:/Users/username/.sbt/boot/scala-2.12.12/org.scala-sbt/sbt/1.4.4/run_2.12-1.4.4.jar)
WARNING: Please consider reporting this to the maintainers of sbt.TrapExit$
WARNING: System::setSecurityManager will be removed in a future release
[info] welcome to sbt 1.4.4 (Eclipse Adoptium Java 17.0.15)
[info] loading settings for project gitbucket-commitgraphs-plugin-build from plugins.sbt ...
[info] loading project definition from C:\Users\username\gitbucket-commitgraphs-plugin\project
[info] loading settings for project root from build.sbt ...
[info] set current project to gitbucket-commitgraphs-plugin (in build file:/C:/Users/username/gitbucket-commitgraphs-plugin/)
[info] me.huzi.gitbucket:gitbucket-commitgraphs-plugin_2.13:4.35.0 [S]
[info]   +-com.typesafe.play:twirl-api_2.13:1.4.2 [S]
[info]     +-org.scala-lang.modules:scala-xml_2.13:1.2.0 [S]
[info]
[success] Total time: 0 s, completed 2025/12/30 9:08:38
```

`sbt compile:dependencyTree` ã§ã‚‚çŠ¶æ³ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚

```
>sbt compile:dependencyTree
WARNING: A terminally deprecated method in java.lang.System has been called
WARNING: System::setSecurityManager has been called by sbt.TrapExit$ (file:/C:/Users/username/.sbt/boot/scala-2.12.12/org.scala-sbt/sbt/1.4.4/run_2.12-1.4.4.jar)
WARNING: Please consider reporting this to the maintainers of sbt.TrapExit$
WARNING: System::setSecurityManager will be removed in a future release
[info] welcome to sbt 1.4.4 (Eclipse Adoptium Java 17.0.15)
[info] loading settings for project gitbucket-commitgraphs-plugin-build from plugins.sbt ...
[info] loading project definition from C:\Users\username\gitbucket-commitgraphs-plugin\project
[info] loading settings for project root from build.sbt ...
[info] set current project to gitbucket-commitgraphs-plugin (in build file:/C:/Users/username/gitbucket-commitgraphs-plugin/)
[info] me.huzi.gitbucket:gitbucket-commitgraphs-plugin_2.13:4.35.0 [S]
[info]   +-com.typesafe.play:twirl-api_2.13:1.4.2 [S]
[info]     +-org.scala-lang.modules:scala-xml_2.13:1.2.0 [S]
[info]
[success] Total time: 0 s, completed 2025/12/30 9:12:17
```

ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å¤‰ãˆã¦ã¿ãŸã‚Šã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤ã—ãŸã‚Šã—ã¦ã¿ã¾ã—ãŸãŒã€ç¾è±¡ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

- scala
- sbt
- sbt-twirl
- sbt-gitbucket-plugin
- jvm

## è§£æ±ºã§ããªã„ã®ã§æ–°è¦ sbt ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã— src ä»¥ä¸‹ã‚’ç§»æ¤ã—ã¦ã¿ã‚‹

gitbucket-commitgraphs-chartjs-plugin ã¨ã„ã†ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã€‚

```scala:build.sbt
name := "gitbucket-commitgraphs-chartjs-plugin"
organization := "io.github.gitbucket"
version := "0.1.0"
scalaVersion := "2.13.16"
gitbucketVersion := "4.36.2"

lazy val root = (project in file(".")).enablePlugins(SbtTwirl)

```

```scala:project\plugins.sbt
addSbtPlugin("io.github.gitbucket" % "sbt-gitbucket-plugin" % "1.6.0")
addSbtPlugin("org.scalameta" % "sbt-scalafmt" % "2.5.6")
addSbtPlugin("org.playframework.twirl" % "sbt-twirl" % "2.0.9")
```

gitbucket-commitgraphs-plugin ã‹ã‚‰ src ã‚’ããã£ã‚Šã‚‚ã‚‰ã£ã¦ãã¾ã™ã€‚

ãã‚Œã‹ã‚‰ã€`sbt compile` ã‚’å®Ÿè¡Œã—ã¾ã—ãŸã€‚

```
>sbt compile
[info] welcome to sbt 1.11.3 (Eclipse Adoptium Java 17.0.15)
[info] loading settings for project gitbucket-commitgraphs-chartjs-plugin-build from plugins.sbt...
[info] loading project definition from C:\Users\y_aka\projects\gitbucket-commitgraphs-chartjs-plugin\project
[info] loading settings for project root from build.sbt...
[info] set current project to gitbucket-commitgraphs-chartjs-plugin (in build file:/C:/Users/y_aka/projects/gitbucket-commitgraphs-chartjs-plugin/)
[info] Executing in batch mode. For better performance use sbt's shell
[info] compiling 7 Scala sources to C:\Users\y_aka\projects\gitbucket-commitgraphs-chartjs-plugin\target\scala-2.13\classes ...
[warn] 3 deprecations
[warn] 5 deprecations (since 4.36.0)
[warn] 8 deprecations in total; re-run with -deprecation for details
[warn] three warnings found
[success] Total time: 8 s, completed 2025/12/30 9:19:54
```

deprecations ã®è­¦å‘Šã¯å‡ºã‚‹ã‚‚ã®ã®ã™ã‚“ãªã‚Šã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚Šã¾ã—ãŸã€‚ãªã‚“ã§ã‚„ã­ã‚“ï¼

## Google Charts ã®å‡¦ç†éƒ¨åˆ†ã‚’èª¿æŸ»ã™ã‚‹

æ‰‹å§‹ã‚ã« [src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html ã®28è¡Œç›®](https://github.com/yoshiyoshifujii/gitbucket-commitgraphs-plugin/blob/7427e3ffb2debf30f49eb72c79547e93e6dc7887/src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html#L28) ã‹ã‚‰å§‹ã¾ã‚‹ä»¥ä¸‹ã®å‡¦ç†ãŒã€ã‚°ãƒ©ãƒ•ã®æç”»ã‚’æ‹…ã£ã¦ã„ã¾ã™ã€‚

```js:src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html
        google.setOnLoadCallback(function() {
          var data = new google.visualization.DataTable();
          data.addColumn('date',"Date");
          data.addColumn('number',"Commits");
          data.addRows([
            @cg.dailys.map { d =>
              @{"[new Date(%4d,%2d,%2d,0,0,0),  %d],".format(d.date.getYear()+1900,d.date.getMonth(),d.date.getDate(),d.commits)}
            }
          ]);

          var options = {
            legend: {position: "none"},
            vAxis: {minValue: 0}
          };

          var chart = new google.visualization.AreaChart(document.getElementById('chart_div_@i'));
          chart.draw(data, options);
        });
```

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æ¸¡ã•ã‚Œã‚‹éš›ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å±•é–‹ã•ã‚Œã¾ã™ã€‚

```js
        google.setOnLoadCallback(function() {
          var data = new google.visualization.DataTable();
          data.addColumn('date',"Date");
          data.addColumn('number',"Commits");
          data.addRows([
            
              [new Date(2025, 6, 7,0,0,0),  2],
            
              [new Date(2025, 7, 2,0,0,0),  16],
            
              [new Date(2025,10,15,0,0,0),  5],
            
              [new Date(2025,10,29,0,0,0),  1],
            
              [new Date(2025,11, 3,0,0,0),  2],
            
              [new Date(2025,11, 4,0,0,0),  1],
            
              [new Date(2025,11, 5,0,0,0),  1],
            
              [new Date(2025,11, 7,0,0,0),  6],
            
              [new Date(2025,11, 8,0,0,0),  2],
            
              [new Date(2025,11, 9,0,0,0),  2],
            
              [new Date(2025,11,10,0,0,0),  9],
            
              [new Date(2025,11,11,0,0,0),  1],
            
              [new Date(2025,11,15,0,0,0),  10],
            
              [new Date(2025,11,16,0,0,0),  4],
            
              [new Date(2025,11,17,0,0,0),  1],
            
              [new Date(2025,11,22,0,0,0),  2],
            
              [new Date(2025,11,23,0,0,0),  2],
            
              [new Date(2025,11,24,0,0,0),  2],
            
          ]);

          var options = {
            legend: {position: "none"},
            vAxis: {minValue: 0}
          };

          var chart = new google.visualization.AreaChart(document.getElementById('chart_div_0'));
          chart.draw(data, options);
        });
```

## chart.js ãªã©å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒæ¢±ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª [src/main/resources/commitgraphs-chartjs/assets](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/tree/main/src/main/resources/commitgraphs-chartjs/assets) ã‚’æ˜ã‚Šã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é…ç½®ã—ã¾ã—ãŸã€‚

- [chart.umd.min.js](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/blob/main/src/main/resources/commitgraphs-chartjs/assets/chart.umd.min.js)
- [chartjs-adapter-luxon.js](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/blob/main/src/main/resources/commitgraphs-chartjs/assets/chartjs-adapter-luxon.js)
- [luxon.js](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/blob/main/src/main/resources/commitgraphs-chartjs/assets/luxon.js)

[chartjs-adapter-luxon](https://github.com/chartjs/chartjs-adapter-luxon) ã¯ã€[luxon](https://moment.github.io/luxon/#/)ã«ã‚ˆã‚Šã€Xè»¸ã«è¡¨ç¤ºã™ã‚‹æ—¥ä»˜ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ­ãƒ¼ã‚±ãƒ«ã«åˆã‚ã›ã¦è¡¨ç¤ºã™ã‚‹ãŸã‚ã® [Date Adapters](https://www.chartjs.org/docs/latest/axes/cartesian/time.html#date-adapters) ã§ã™ã€‚

## assetsMappings ã‚’è¨­å®š

[src/main/scala/Plugin.scala](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/blob/f131c6cfcee5203d5f379c23c49d6df1b1d24ea0/src/main/scala/Plugin.scala#L22) ã§ `assetsMappings` ã‚’ override ã—ã€åŒæ¢±ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```scala:src/main/scala/Plugin.scala
override val assetsMappings = Seq("/commitgraphs-chartjs" -> "/commitgraphs-chartjs/assets")
```

## chart.js ã‚’ä½¿ç”¨ã—ã¦ã‚°ãƒ©ãƒ•ã‚’æç”»ã™ã‚‹ã‚ˆã†ã«ä¿®æ­£

[src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html](https://github.com/yasumichi/gitbucket-commitgraphs-chartjs-plugin/blob/f131c6cfcee5203d5f379c23c49d6df1b1d24ea0/src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html) ã‚’ä¿®æ­£ã—ã¾ã—ãŸã€‚

ã¾ãšã€åŒæ¢±ã—ãŸ JavaScript ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ã—ã¾ã™ã€‚

```html:src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html
    <script src="@context.path/plugin-assets/commitgraphs-chartjs/chart.umd.min.js"></script>
    <script src="@context.path/plugin-assets/commitgraphs-chartjs/luxon.js"></script>
    <script src="@context.path/plugin-assets/commitgraphs-chartjs/chartjs-adapter-luxon.js"></script>
```


[Google Charts](https://developers.google.com/chart) ã§ã¯ Xè»¸ã®å€¤ã¨Yè»¸ã®å€¤ãŒå¯¾ã«ãªã£ã¦ã„ã¾ã—ãŸãŒã€ [chart.js](https://www.chartjs.org/) ã§ã¯ã€Xè»¸ã¨Yè»¸ã‚’åˆ¥ã®é…åˆ—ã§å®šç¾©ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ã¾ãšã¯ã€Xè»¸ã®å€¤ã‚’å®šç¾©ã—ã¾ã™ã€‚

```js:src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html
        var dateLabels@i = [
          @cg.dailys.map { d =>
            @{"new Date(%4d,%2d,%2d,0,0,0),".format(d.date.getYear()+1900,d.date.getMonth(),d.date.getDate()) }
          }
        ];
```

å®Ÿã¯ã“ã®éƒ¨åˆ†ã€Scala ã¨ã„ã†ã‹ Java çš„ã«ã¯ã€deprecations ãªã‚³ãƒ¼ãƒ‰ãŒå…¥ã£ã¦ã„ã¾ã™ã€‚(java.util.Date ã® getYearãªã©)

æ¬¡ã«Yè»¸ã®å€¤ã‚’å®šç¾©ã™ã‚‹ã¨ã¨ã‚‚ã«å…ˆã»ã©å®šç¾©ã—ãŸXè»¸ã‚’é–¢é€£ä»˜ã‘ã¾ã™ã€‚ã‚ªãƒªã‚¸ãƒŠãƒ«ã«åˆã‚ã›ã¦ã€ã‚°ãƒ©ãƒ•ã‚’å¡—ã‚Šã¤ã¶ã™ã‚ˆã†ã« `fill` ã‚’ `true` ã«ã—ã¦ã„ã¾ã™ã€‚

```js:src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html
        var data@i = {
          labels: dateLabels@i,
          datasets: [{
            label: 'Commits',
            data: [
              @cg.dailys.map { d =>
                @{"%d,".format(d.commits)}
              }
            ],
            fill: true
          }]
        };
```

ã‚°ãƒ©ãƒ•ã®è¨­å®šã‚’å®šç¾©ã—ã¾ã™ã€‚

```js:src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html
        var lineConfig@i = {
          type: 'line',
          data: data@i,
          options: {
            responsive: true,
            locale: navigator.language,
            scales: {
              x: {
                  type: 'time',
                  time: {
                      unit: 'day'
                  }
              },
              y: {
                beginAtZero: true
              }
            },
            plugins: {
              legend: {
                position: 'top',
              },
              title: {
                display: true,
                text: 'Commits over Time'
              }
            }
          },
        };
```

ãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šã€‚

- `locale` ã‚’ `navigator.language` ã‹ã‚‰å–å¾—
- Xè»¸ã® `type` ã‚’ `time` ã«ã™ã‚‹ã“ã¨ã§æ—¥ä»˜é–“éš”ã‚’èª¿æ•´

Copilot ã‹ã‚‰ã‚µã‚¸ã‚§ã‚¹ãƒˆã•ã‚ŒãŸ plugins ã¯ãªãã¦ã‚‚è‰¯ã‹ã£ãŸã‹ãªâ€¦

ä»¥ä¸Šã‹ã‚‰ã€ã‚°ãƒ©ãƒ•ã‚’æç”»ã—ã¾ã™ã€‚

```js:src/main/twirl/me/huzi/gitbucket/commitgraphs/list.scala.html
        var myChart@i = new Chart(
          document.getElementById('chart_div_@i'),
          lineConfig@i
        );
```

ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã¾ã¾ã€ã‚¿ã‚°ã® id ã‚’ãã®ã¾ã¾ä½¿ã£ã¦ã¾ã™ãŒã€div ã‹ã‚‰ canvas ã«å¤‰ãˆãŸã®ã§åˆã‚ã›ãŸæ–¹ãŒè‰¯ã‹ã£ãŸã‹ãªâ€¦